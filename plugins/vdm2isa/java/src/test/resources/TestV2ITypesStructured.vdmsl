module TestV2ITypesStructured
--avoid TRRenamedDefinition for now! 
--imports from VDMToolkit 
--	functions seq_prefix renamed seq_prefix;
exports all
definitions

types	
	
	TSet = set of nat1
	inv s       == s <> {}
	eq  s1 = s2 == s1 subset s2
	ord s1 < s2 == card s1 < card s2
	;
	
	TSet2 = TSet
	inv s == card s > 10;
	
	TSet3 = set of TSet;
	
	TSet4 = set of TSet3
	inv s == card s > 20;

	TSeq = seq1 of nat1
	inv s       == card elems s = len s
	eq  s1 = s2 == elems s1 = elems s2
	ord s1 < s2 == len s1 < len s2--seq_prefix[TSet](s1, s2)
	; 
	
	TSeq2 = seq1 of TSet
	inv s       == card elems s = len s
	eq  s1 = s2 == elems s1 = elems s2
	ord s1 < s2 == len s1 < len s2--seq_prefix[TSet](s1, s2)
	; 

	TMap = map nat1 to nat1 
	inv m == dom m <> {}
	eq m1 = m2 == dom m1 = dom m2 and (forall x in set dom m1 & m1(x) = m2(x))
	ord m1 < m2 == 
		dom m1 subset dom m2
		or
		(dom m1 = dom m2 and (forall x in set dom m1 & m1(x) < m2(x)))
	;
/*
	
	TOptional = [nat1]
	inv o1 == o1 <> nil => o1 > 10
	;

	
	TFcn = (nat1 -> nat1)
	inv f == (forall x in set {1,2,3} & x > 1 => f(x) > 10)
	;
	
values
	v: TFcn = (lambda x: nat1 & (x * x) + 10)
	;
	*/
end TestV2ITypesStructured
